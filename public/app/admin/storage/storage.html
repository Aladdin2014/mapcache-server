<div class="row" ng-controller="StorageController">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-12">
            <span class="page-entity-label">mapcache Disk Usage <span class="page-entity-title">{{storage.used | fileSize}} of {{storage.total | fileSize}}</span></span>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="progress">
              <div class="progress-bar"
                 ng-class="{'progress-bar-success': (storage.used/storage.total) < .75, 'progress-bar-warning': (storage.used/storage.total) > .75 && (storage.used/storage.total) < .90, 'progress-bar-danger': (storage.used/storage.total) > .90}"
                 role="progressbar" style="width: {{100*(storage.used/storage.total)}}%">
                <span>{{100*(storage.used/storage.total) | number:2}}% used</span>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <span class="page-entity-label">Server Disk Usage <span class="page-entity-title">{{(storage.serverTotal - storage.serverFree) | fileSize}} of {{storage.serverTotal | fileSize}}</span></span>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="progress">
              <div class="progress-bar"
                 ng-class="{'progress-bar-success': ((storage.serverTotal - storage.serverFree)/storage.serverTotal) < .75, 'progress-bar-warning': ((storage.serverTotal - storage.serverFree)/storage.serverTotal) > .75 && ((storage.serverTotal - storage.serverFree)/storage.serverTotal) < .90, 'progress-bar-danger': ((storage.serverTotal - storage.serverFree)/storage.serverTotal) > .90}"
                 role="progressbar" style="width: {{100*((storage.serverTotal - storage.serverFree)/storage.serverTotal)}}%">
                <span>{{100*(storage.used/storage.total) | number:2}}% used</span>
              </div>
            </div>
          </div>
        </div>
        <hr>
        <div class="row">
          <div class="col-md-12">
            <span class="page-entity-label">Cache Disk Usage</span>
          </div>
        </div>
        <div class="row bottom-gap" ng-repeat="cache in caches | orderBy: 'totalSize':true">
          <div class="col-md-12">
            <span class="page-entity-label">{{cache.name}} <span class="page-entity-title">{{cache.totalSize | fileSize}}</span></span>
            <div class="progress usage-progress">
              <div class="progress-bar"
                 ng-class="{'progress-bar-success': (cache.totalSize/storage.serverTotal) < .75, 'progress-bar-warning': (cache.totalSize/storage.serverTotal) > .75 && (cache.totalSize/storage.serverTotal) < .90, 'progress-bar-danger': (cache.totalSize/storage.serverTotal) > .90}"
                 role="progressbar" style="width: {{100*(cache.totalSize/storage.used)}}%">
                <span>{{100*(cache.totalSize/storage.used) | number:2}}% of usage</span>
              </div>
            </div>
            <div>
              <span class="page-sub-entity-label">Tiles <span class="page-sub-entity-title">{{cache.tileSize | fileSize}}</span></span>
            </div>
            <div ng-repeat="(format, info) in cache.formats">
              <span class="page-sub-entity-label">{{formatName(format)}} <span class="page-sub-entity-title">{{info.size | fileSize}}</span></span>
            </div>
          </div>
        </div>
        <hr>
        <div class="row">
          <div class="col-md-12">
            <span class="page-entity-label">Source Disk Usage</span>
          </div>
        </div>
        <div class="row bottom-gap" ng-repeat="source in sources | orderBy: 'size': false">
          <div class="col-md-12">
            <span class="page-entity-label">{{source.name}}:{{formatName(source.format)}} <span class="page-entity-title">{{source.size | fileSize}}</span></span>
            <div class="progress usage-progress">
              <div class="progress-bar" ng-class="{'progress-bar-success': (source.size/storage.serverTotal) < .75, 'progress-bar-warning': (source.size/storage.serverTotal) > .75 && (source.size/storage.serverTotal) < .90, 'progress-bar-danger': (source.size/storage.serverTotal) > .90}"
                 role="progressbar" style="width: {{100*(source.size/storage.used)}}%">
                <span>{{100*(source.size/storage.used) | number:2}}% of usage</span>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>
